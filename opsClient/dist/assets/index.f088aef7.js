import{b as O,a as J,u as H,g as K,d as Q}from"./table.46e62b71.js";import{d as B,k as h,ay as z,_ as T,r as f,aT as U,o as g,c as b,a as $,b as l,bd as j,F as S,x as k,n as R,t as F,ai as N,p as W,f as X,bF as Y,q as E,w as p,e as C,j as A,A as Z,E as M,aP as x}from"./index.17213d34.js";import{T as ee}from"./index.a9f44871.js";import{P as ae}from"./Plus.c665c221.js";import{S as te}from"./Search.91283474.js";import{D as le}from"./Delete.d2b3d8a8.js";function q(e,a,n,s){var i,c=!1,o=0;function d(){i&&clearTimeout(i)}function u(){d(),c=!0}typeof a!="boolean"&&(s=n,n=a,a=void 0);function v(){for(var y=arguments.length,_=new Array(y),m=0;m<y;m++)_[m]=arguments[m];var r=this,t=Date.now()-o;if(c)return;function w(){o=Date.now(),n.apply(r,_)}function D(){i=void 0}s&&!i&&w(),d(),s===void 0&&t>e?w():a!==!0&&(i=setTimeout(s?D:w,s===void 0?e-t:e))}return v.cancel=u,v}function oe(e,a,n){return n===void 0?q(e,a,!1):q(e,n,a!==!1)}const ne=B({setup(){const e=h(null),a={index:1,size:30,total:0};let n=h(""),s=h([]),i=h(!0),c=h(!0),o=z("active"),d=h(!1);const u=_=>{if(c.value=!0,_||i.value)i.value=!1,a.index=1,e.value&&(e.value.scrollTop=0);else if(a.index*a.size>=a.total){c.value=!1,d.value=!0;return}let m={page:a.index,pageSize:a.size,keyword:n.value};O(m).then(r=>{a.index===1?(s.value=r.data.list,o.value=s.value[0]):s.value=s.value.concat(r.data.list),a.index+=1,a.total=r.data.pager.total}).catch(r=>{a.index=1,a.total=0,s.value=[]}).finally(()=>{c.value=!1})},v=oe(300,u),y=_=>{o.value=_};return u(!0),{listDom:e,loading:c,nomore:d,input:n,list:s,active:o,getCategoryData:u,searchData:v,changeActive:y}}}),re=e=>(W("data-v-3275f7a8"),e=e(),X(),e),se={class:"category"},ue={class:"header-box"},ie=re(()=>$("h2",null,"\u5206\u7C7B\u5217\u8868",-1)),de={class:"list system-scrollbar",ref:"listDom","infinite-scroll-immediate":!1,style:{overflow:"auto"}},me=["onClick"],ce={key:0,class:"load-tip"},pe={key:1,class:"load-tip"};function fe(e,a,n,s,i,c){const o=f("el-input"),d=U("infinite-scroll");return g(),b("div",se,[$("div",ue,[ie,l(o,{modelValue:e.input,"onUpdate:modelValue":a[0]||(a[0]=u=>e.input=u),placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",onInput:a[1]||(a[1]=u=>e.searchData(!0))},null,8,["modelValue"])]),j((g(),b("ul",de,[(g(!0),b(S,null,k(e.list,u=>(g(),b("li",{key:u.id,class:R({active:u.id===e.active.id}),onClick:v=>e.changeActive(u)},[$("span",null,F(u.name),1)],10,me))),128)),e.loading?(g(),b("p",ce,"\u52A0\u8F7D\u4E2D...")):N("",!0),e.nomore?(g(),b("p",pe,"\u6570\u636E\u52A0\u8F7D\u5B8C\u6210")):N("",!0)])),[[d,e.getCategoryData]])])}var ve=T(ne,[["render",fe],["__scopeId","data-v-3275f7a8"]]);const G=[{value:1,label:"\u8FD0\u52A8"},{value:2,label:"\u5065\u8EAB"},{value:3,label:"\u8DD1\u9177"},{value:4,label:"\u8857\u821E"}],P=[{value:1,label:"\u4ECA\u5929"},{value:2,label:"\u660E\u5929"},{value:3,label:"\u540E\u5929"}],ge=B({components:{Layer:Y},props:{layer:{type:Object,default:()=>({show:!1,title:"",showButton:!0})}},setup(e,a){const n=h(null),s=h(null);let i=h({name:""});const c={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D",trigger:"blur"}],number:[{required:!0,message:"\u8BF7\u8F93\u5165\u6570\u5B57",trigger:"blur"}],choose:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}],radio:[{required:!0,message:"\u8BF7\u9009\u62E9",trigger:"blur"}]};o();function o(){e.layer.row&&(i.value=JSON.parse(JSON.stringify(e.layer.row)))}return{form:i,rules:c,layerDom:s,ruleForm:n,selectData:G,radioData:P}},methods:{submit(){this.ruleForm&&this.ruleForm.validate(e=>{if(e){let a=this.form;this.layer.row?this.updateForm(a):this.addForm(a)}else return!1})},addForm(e){J(e).then(a=>{this.$message({type:"success",message:"\u65B0\u589E\u6210\u529F"}),this.$emit("getTableData",!0),this.layerDom&&this.layerDom.close()})},updateForm(e){H(e).then(a=>{this.$message({type:"success",message:"\u7F16\u8F91\u6210\u529F"}),this.$emit("getTableData",!1),this.layerDom&&this.layerDom.close()})}}});function he(e,a,n,s,i,c){const o=f("el-input"),d=f("el-form-item"),u=f("el-option"),v=f("el-select"),y=f("el-radio"),_=f("el-radio-group"),m=f("el-form"),r=f("Layer",!0);return g(),E(r,{layer:e.layer,onConfirm:e.submit,ref:"layerDom"},{default:p(()=>[l(m,{model:e.form,rules:e.rules,ref:"ruleForm","label-width":"120px",style:{"margin-right":"30px"}},{default:p(()=>[l(d,{label:"\u540D\u79F0\uFF1A",prop:"name"},{default:p(()=>[l(o,{modelValue:e.form.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.form.name=t),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u6570\u5B57\uFF1A",prop:"number"},{default:p(()=>[l(o,{modelValue:e.form.number,"onUpdate:modelValue":a[1]||(a[1]=t=>e.form.number=t),oninput:"value=value.replace(/[^\\d]/g,'')",placeholder:"\u53EA\u80FD\u8F93\u5165\u6B63\u6574\u6570"},null,8,["modelValue"])]),_:1}),l(d,{label:"\u9009\u62E9\u5668\uFF1A",prop:"select"},{default:p(()=>[l(v,{modelValue:e.form.choose,"onUpdate:modelValue":a[2]||(a[2]=t=>e.form.choose=t),placeholder:"\u8BF7\u9009\u62E9",clearable:""},{default:p(()=>[(g(!0),b(S,null,k(e.selectData,t=>(g(),E(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{label:"\u5355\u9009\u6846\uFF1A",prop:"radio"},{default:p(()=>[l(_,{modelValue:e.form.radio,"onUpdate:modelValue":a[3]||(a[3]=t=>e.form.radio=t)},{default:p(()=>[(g(!0),b(S,null,k(e.radioData,t=>(g(),E(y,{key:t.value,label:t.value},{default:p(()=>[C(F(t.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["layer","onConfirm"])}var _e=T(ge,[["render",he]]);const ye=B({components:{Table:ee,Layer:_e},setup(){const e=A({input:""}),a=A({show:!1,title:"\u65B0\u589E",showButton:!0}),n=A({index:1,size:20,total:0}),s=z("active"),i=h(!0),c=h([]),o=h([]),d=m=>{o.value=m},u=m=>{i.value=!0,m&&(n.index=1);let r={category:s.value.id,page:n.index,pageSize:n.size,...e};K(r).then(t=>{let w=t.data.list;Array.isArray(w)&&w.forEach(D=>{const I=G.find(V=>V.value===D.choose);I?D.chooseName=I.label:D.chooseName=D.choose;const L=P.find(V=>V.value===D.radio);L?D.radioName=L.label:D.radio}),c.value=t.data.list,n.total=Number(t.data.pager.total)}).catch(t=>{c.value=[],n.index=1,n.total=0}).finally(()=>{i.value=!1})},v=m=>{let r={ids:m.map(t=>t.id).join(",")};Q(r).then(t=>{M({type:"success",message:"\u5220\u9664\u6210\u529F"}),u(c.value.length===1)})},y=()=>{a.title="\u65B0\u589E\u6570\u636E",a.show=!0,delete a.row},_=m=>{a.title="\u7F16\u8F91\u6570\u636E",a.row=m,a.show=!0};return Z(s,m=>{u(!0)}),{Plus:ae,Search:te,Delete:le,query:e,tableData:c,chooseData:o,loading:i,page:n,layer:a,handleSelectionChange:d,handleAdd:y,handleEdit:_,handleDel:v,getTableData:u}}}),be={class:"layout-container"},De={class:"layout-container-form flex space-between"},$e={class:"layout-container-form-handle"},Fe={class:"layout-container-form-search"},we={class:"layout-container-table"};function Ce(e,a,n,s,i,c){const o=f("el-button"),d=f("el-popconfirm"),u=f("el-input"),v=f("el-table-column"),y=f("Table"),_=f("Layer"),m=U("loading");return g(),b("div",be,[$("div",De,[$("div",$e,[l(o,{type:"primary",icon:e.Plus,onClick:e.handleAdd},{default:p(()=>[C(F(e.$t("message.common.add")),1)]),_:1},8,["icon","onClick"]),l(d,{title:e.$t("message.common.delTip"),onConfirm:a[0]||(a[0]=r=>e.handleDel(e.chooseData))},{reference:p(()=>[l(o,{type:"danger",icon:e.Delete,disabled:e.chooseData.length===0},{default:p(()=>[C(F(e.$t("message.common.delBat")),1)]),_:1},8,["icon","disabled"])]),_:1},8,["title"])]),$("div",Fe,[l(u,{modelValue:e.query.input,"onUpdate:modelValue":a[1]||(a[1]=r=>e.query.input=r),placeholder:e.$t("message.common.searchTip"),onChange:a[2]||(a[2]=r=>e.getTableData(!0))},null,8,["modelValue","placeholder"]),l(o,{type:"primary",icon:e.Search,class:"search-btn",onClick:a[3]||(a[3]=r=>e.getTableData(!0))},{default:p(()=>[C(F(e.$t("message.common.search")),1)]),_:1},8,["icon"])])]),$("div",we,[j((g(),E(y,{ref:"table",page:e.page,"onUpdate:page":a[4]||(a[4]=r=>e.page=r),showIndex:!0,showSelection:!0,data:e.tableData,onGetTableData:e.getTableData,onSelectionChange:e.handleSelectionChange},{default:p(()=>[l(v,{prop:"name",label:"\u540D\u79F0",align:"center"}),l(v,{prop:"number",label:"\u6570\u5B57",align:"center"}),l(v,{prop:"chooseName",label:"\u9009\u62E9\u5668",align:"center"}),l(v,{prop:"radioName",label:"\u5355\u9009\u6846",align:"center"}),l(v,{label:e.$t("message.common.handle"),align:"center",fixed:"right",width:"200"},{default:p(r=>[l(o,{onClick:t=>e.handleEdit(r.row)},{default:p(()=>[C(F(e.$t("message.common.update")),1)]),_:2},1032,["onClick"]),l(d,{title:e.$t("message.common.delTip"),onConfirm:t=>e.handleDel([r.row])},{reference:p(()=>[l(o,{type:"danger"},{default:p(()=>[C(F(e.$t("message.common.del")),1)]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["label"])]),_:1},8,["page","data","onGetTableData","onSelectionChange"])),[[m,e.loading]]),e.layer.show?(g(),E(_,{key:0,layer:e.layer,onGetTableData:e.getTableData},null,8,["layer","onGetTableData"])):N("",!0)])])}var Ee=T(ye,[["render",Ce],["__scopeId","data-v-27c5c183"]]);const Be=B({name:"categoryTable",components:{Category:ve,myTable:Ee},setup(){let e=h({});x("active",e)}}),Te={class:"full"},Ve={class:"left"},Ae={class:"content"};function Se(e,a,n,s,i,c){const o=f("category"),d=f("my-table");return g(),b("div",Te,[$("div",Ve,[l(o)]),$("div",Ae,[l(d)])])}var Ue=T(Be,[["render",Se],["__scopeId","data-v-1bfbe078"]]);export{Ue as default};
